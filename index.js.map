{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const fetchPhotosByQuery = async (\n  searchQuery,\n  currentPage,\n  perPage = 15\n) => {\n  try {\n    const response = await axios.get('https://pixabay.com/api/', {\n      params: {\n        q: searchQuery,\n        key: '48331487-0b79b5362db2718bcf5a2a310',\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        per_page: perPage,\n        page: currentPage,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching data from Pixabay:', error);\n    throw error;\n  }\n};\n","export const createGalleryCardTemplate = imgInfo => {\n  return `<li class=\"gallery-card\">\n            <article class=\"card\">\n            <a class=\"gallery-link\" href=\"${imgInfo.largeImageURL}\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <img class=\"gallery-img\" src=\"${imgInfo.webformatURL}\" alt=\"${imgInfo.tags}\" />\n            </a>\n            <div class=\"gallery-container\">\n              <div class=\"gallery-item\">\n                <p class=\"gallery-title\">Likes</p>\n                <p class=\"gallery-count\">${imgInfo.likes}</p>\n              </div>\n              <div class=\"gallery-item\">\n                <p class=\"gallery-title\">Views</p>\n                <p class=\"gallery-count\">${imgInfo.views}</p>\n              </div>\n              <div class=\"gallery-item\">\n                <p class=\"gallery-title\">Comments</p>\n                <p class=\"gallery-count\">${imgInfo.comments}</p>\n              </div>\n              <div class=\"gallery-item\">\n                <p class=\"gallery-title\">Downloads</p>\n                <p class=\"gallery-count\">${imgInfo.downloads}</p>\n              </div>\n            </div>\n          </article>\n        </li>`;\n};\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchPhotosByQuery } from './js/pixabay-api';\nimport { createGalleryCardTemplate } from './js/render-functions';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const searchFormEl = document.querySelector('.js-search-form');\n  const galleryEl = document.querySelector('.js-gallery');\n  const loader = document.querySelector('.loader');\n  const loadMoreButton = document.querySelector('.js-load-more');\n  const endMessage = document.querySelector('.js-end-message');\n\n  let currentPage = 1;\n  let searchQuery = '';\n  let totalHits = 0;\n  let loadedImages = 0;\n  let gallery = null;\n\n  function toggleLoader(isLoading) {\n    if (isLoading) {\n      loader.classList.remove('is-hidden');\n    } else {\n      loader.classList.add('is-hidden');\n    }\n  }\n\n  const onSearchFormSubmit = async event => {\n    event.preventDefault();\n\n    const searchedQuery = event.currentTarget.elements.user_query.value.trim();\n    if (searchedQuery === '') {\n      iziToast.error({\n        message: 'Please enter your request',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    searchQuery = searchedQuery;\n    currentPage = 1;\n    loadedImages = 0;\n    galleryEl.innerHTML = '';\n    toggleLoader(true);\n\n    try {\n      const data = await fetchPhotosByQuery(searchQuery, currentPage, 15);\n      totalHits = data.total;\n      loadedImages += data.hits.length;\n\n      if (data.total === 0) {\n        iziToast.error({\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          position: 'topRight',\n        });\n        toggleLoader(false);\n        return;\n      }\n\n      const galleryTemplate = data.hits.map(createGalleryCardTemplate).join('');\n      galleryEl.innerHTML = galleryTemplate;\n      toggleLoader(false);\n\n      if (loadedImages >= totalHits) {\n        loadMoreButton.classList.add('is-hidden');\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n          timeout: 3000,\n        });\n      } else {\n        loadMoreButton.classList.remove('is-hidden');\n      }\n\n      if (!gallery) {\n        gallery = new SimpleLightbox('.js-gallery a', {\n          captionDelay: 300,\n          captionsData: 'alt',\n        });\n      } else {\n        gallery.refresh();\n      }\n\n      window.scrollBy({\n        top: window.innerHeight / 2,\n        behavior: 'smooth',\n      });\n    } catch (err) {\n      console.log(err);\n      toggleLoader(false);\n    }\n  };\n\n  const onLoadMoreClick = async () => {\n    if (loadedImages >= totalHits) {\n      return;\n    }\n\n    currentPage += 1;\n    toggleLoader(true);\n\n    try {\n      const data = await fetchPhotosByQuery(searchQuery, currentPage, 15);\n      loadedImages += data.hits.length;\n\n      const galleryTemplate = data.hits.map(createGalleryCardTemplate).join('');\n      galleryEl.insertAdjacentHTML('beforeend', galleryTemplate);\n      toggleLoader(false);\n\n      if (loadedImages >= totalHits) {\n        loadMoreButton.classList.add('is-hidden');\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n          timeout: 3000,\n        });\n      }\n\n      gallery.refresh();\n\n      window.scrollBy({\n        top: window.innerHeight / 2,\n        behavior: 'smooth',\n      });\n    } catch (err) {\n      console.log(err);\n      toggleLoader(false);\n    }\n  };\n\n  searchFormEl.addEventListener('submit', onSearchFormSubmit);\n  loadMoreButton.addEventListener('click', onLoadMoreClick);\n});\n"],"names":["fetchPhotosByQuery","searchQuery","currentPage","perPage","axios","error","createGalleryCardTemplate","imgInfo","searchFormEl","galleryEl","loader","loadMoreButton","totalHits","loadedImages","gallery","toggleLoader","isLoading","onSearchFormSubmit","event","searchedQuery","iziToast","data","galleryTemplate","SimpleLightbox","err","onLoadMoreClick"],"mappings":"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"}